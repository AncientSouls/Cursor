{"version":3,"sources":["../src/tests/subscription.js"],"names":["SubscriptionTest","generateGraph","ids","describe","it","done","graph","emitted","on","oldLink","newLink","insert","source","target","error","id1","ifError","equal","update","count","remove"],"mappings":"8EAEgBA,gB,CAAAA,gB,CAFhB,0BAEO,QAASA,iBAAT,CAA2BC,aAA3B,CAA0CC,GAA1C,CAA+C,CACpDC,SAAS,oBAAT,CAA+B,UAAW,CACxCC,GAAG,iCAAH,CAAsC,SAACC,IAAD,CAAU,CAC9C,GAAIC,OAAQL,eAAZ,CACA,GAAIM,SAAU,EAAd,CACAD,MAAME,EAAN,CAAS,MAAT,CAAiB,SAACC,OAAD,CAAUC,OAAV,QAAsBH,UAAS,MAA/B,CAAjB,EACAD,MAAME,EAAN,CAAS,MAAT,CAAiB,SAACC,OAAD,CAAUC,OAAV,QAAsBH,UAAS,MAA/B,CAAjB,IACAD,MAAME,EAAN,CAAS,QAAT,CAAmB,SAACC,OAAD,CAAUC,OAAV,QAAsBH,UAAS,QAA/B,CAAnB,EACAD,MAAME,EAAN,CAAS,QAAT,CAAmB,SAACC,OAAD,CAAUC,OAAV,QAAsBH,UAAS,QAA/B,CAAnB,IACAD,MAAME,EAAN,CAAS,QAAT,CAAmB,SAACC,OAAD,CAAUC,OAAV,QAAsBH,UAAS,QAA/B,CAAnB,EACAD,MAAME,EAAN,CAAS,QAAT,CAAmB,SAACC,OAAD,CAAUC,OAAV,QAAsBH,UAAS,QAA/B,CAAnB,IACAD,MAAME,EAAN,CAAS,QAAT,CAAmB,SAACC,OAAD,CAAUC,OAAV,QAAsBH,UAAS,QAA/B,CAAnB,EACAD,MAAME,EAAN,CAAS,QAAT,CAAmB,SAACC,OAAD,CAAUC,OAAV,QAAsBH,UAAS,QAA/B,CAAnB,IACAD,MAAME,EAAN,CAAS,QAAT,CAAmB,SAACC,OAAD,CAAUC,OAAV,QAAsBH,UAAS,QAA/B,CAAnB,EACAD,MAAME,EAAN,CAAS,QAAT,CAAmB,SAACC,OAAD,CAAUC,OAAV,QAAsBH,UAAS,QAA/B,CAAnB,IACAD,MAAMK,MAAN,CAAa,CAAEC,OAAQV,IAAI,CAAJ,CAAV,CAAkBW,OAAQX,IAAI,CAAJ,CAA1B,CAAb,CAAiD,SAACY,KAAD,CAAQC,GAAR,CAAgB,CAC/D,aAAOC,OAAP,CAAeF,KAAf,EACA,aAAOG,KAAP,CAAaV,OAAb,CAAsB,YAAtB,EACAF,MACD,CAJD,CAKD,CAlBD,EAmBAD,GAAG,iCAAH,CAAsC,SAACC,IAAD,CAAU,CAC9C,GAAIC,OAAQL,eAAZ,CACA,GAAIM,SAAU,EAAd,CACAD,MAAME,EAAN,CAAS,MAAT,CAAiB,SAACC,OAAD,CAAUC,OAAV,QAAsBH,UAAS,MAA/B,CAAjB,EACAD,MAAME,EAAN,CAAS,MAAT,CAAiB,SAACC,OAAD,CAAUC,OAAV,QAAsBH,UAAS,MAA/B,CAAjB,IACAD,MAAME,EAAN,CAAS,QAAT,CAAmB,SAACC,OAAD,CAAUC,OAAV,QAAsBH,UAAS,QAA/B,CAAnB,EACAD,MAAME,EAAN,CAAS,QAAT,CAAmB,SAACC,OAAD,CAAUC,OAAV,QAAsBH,UAAS,QAA/B,CAAnB,IACAD,MAAME,EAAN,CAAS,QAAT,CAAmB,SAACC,OAAD,CAAUC,OAAV,QAAsBH,UAAS,QAA/B,CAAnB,EACAD,MAAME,EAAN,CAAS,QAAT,CAAmB,SAACC,OAAD,CAAUC,OAAV,QAAsBH,UAAS,QAA/B,CAAnB,IACAD,MAAME,EAAN,CAAS,QAAT,CAAmB,SAACC,OAAD,CAAUC,OAAV,QAAsBH,UAAS,QAA/B,CAAnB,EACAD,MAAME,EAAN,CAAS,QAAT,CAAmB,SAACC,OAAD,CAAUC,OAAV,QAAsBH,UAAS,QAA/B,CAAnB,IACAD,MAAME,EAAN,CAAS,QAAT,CAAmB,SAACC,OAAD,CAAUC,OAAV,QAAsBH,UAAS,QAA/B,CAAnB,EACAD,MAAME,EAAN,CAAS,QAAT,CAAmB,SAACC,OAAD,CAAUC,OAAV,QAAsBH,UAAS,QAA/B,CAAnB,IACAD,MAAMK,MAAN,CAAa,CAAEC,OAAQV,IAAI,CAAJ,CAAV,CAAkBW,OAAQX,IAAI,CAAJ,CAA1B,CAAb,CAAiD,SAASY,KAAT,CAAgBC,GAAhB,CAAqB,CACpE,aAAOC,OAAP,CAAeF,KAAf,EACAR,MAAMY,MAAN,CAAaH,GAAb,CAAkB,CAAEF,OAAQX,IAAI,CAAJ,CAAV,CAAlB,CAAsC,SAASY,KAAT,CAAgBK,KAAhB,CAAuB,CAC3D,aAAOH,OAAP,CAAeF,KAAf,EACA,aAAOG,KAAP,CAAaV,OAAb,CAAsB,4BAAtB,EACAF,MACD,CAJD,CAKD,CAPD,CAQD,CArBD,EAsBAD,GAAG,iCAAH,CAAsC,SAACC,IAAD,CAAU,CAC9C,GAAIC,OAAQL,eAAZ,CACA,GAAIM,SAAU,EAAd,CACAD,MAAME,EAAN,CAAS,MAAT,CAAiB,SAACC,OAAD,CAAUC,OAAV,QAAsBH,UAAS,MAA/B,CAAjB,EACAD,MAAME,EAAN,CAAS,MAAT,CAAiB,SAACC,OAAD,CAAUC,OAAV,QAAsBH,UAAS,MAA/B,CAAjB,IACAD,MAAME,EAAN,CAAS,QAAT,CAAmB,SAACC,OAAD,CAAUC,OAAV,QAAsBH,UAAS,QAA/B,CAAnB,EACAD,MAAME,EAAN,CAAS,QAAT,CAAmB,SAACC,OAAD,CAAUC,OAAV,QAAsBH,UAAS,QAA/B,CAAnB,IACAD,MAAME,EAAN,CAAS,QAAT,CAAmB,SAACC,OAAD,CAAUC,OAAV,QAAsBH,UAAS,QAA/B,CAAnB,EACAD,MAAME,EAAN,CAAS,QAAT,CAAmB,SAACC,OAAD,CAAUC,OAAV,QAAsBH,UAAS,QAA/B,CAAnB,IACAD,MAAME,EAAN,CAAS,QAAT,CAAmB,SAACC,OAAD,CAAUC,OAAV,QAAsBH,UAAS,QAA/B,CAAnB,EACAD,MAAME,EAAN,CAAS,QAAT,CAAmB,SAACC,OAAD,CAAUC,OAAV,QAAsBH,UAAS,QAA/B,CAAnB,IACAD,MAAME,EAAN,CAAS,QAAT,CAAmB,SAACC,OAAD,CAAUC,OAAV,QAAsBH,UAAS,QAA/B,CAAnB,EACAD,MAAME,EAAN,CAAS,QAAT,CAAmB,SAACC,OAAD,CAAUC,OAAV,QAAsBH,UAAS,QAA/B,CAAnB,IACAD,MAAMK,MAAN,CAAa,CAAEC,OAAQV,IAAI,CAAJ,CAAV,CAAkBW,OAAQX,IAAI,CAAJ,CAA1B,CAAb,CAAiD,SAASY,KAAT,CAAgBC,GAAhB,CAAqB,CACpE,aAAOC,OAAP,CAAeF,KAAf,EACAR,MAAMc,MAAN,CAAaL,GAAb,CAAkB,SAASD,KAAT,CAAgBK,KAAhB,CAAuB,CACvC,aAAOH,OAAP,CAAeF,KAAf,EACA,aAAOG,KAAP,CAAaV,OAAb,CAAsB,wBAAtB,EACAF,MACD,CAJD,CAKD,CAPD,CAQD,CArBD,CAsBD,CAhED,CAiED","file":"subscription.js","sourcesContent":["import { assert } from 'chai';\n\nexport function SubscriptionTest (generateGraph, ids) {\n  describe('Subscription tests', function() {\n    it('should insert and check handler', (done) => {\n      var graph = generateGraph();\n      var emitted = '';\n      graph.on('link', (oldLink, newLink) => emitted+='link');\n      graph.on('link', (oldLink, newLink) => emitted+='link')();\n      graph.on('unlink', (oldLink, newLink) => emitted+='unlink');\n      graph.on('unlink', (oldLink, newLink) => emitted+='unlink')();\n      graph.on('insert', (oldLink, newLink) => emitted+='insert');\n      graph.on('insert', (oldLink, newLink) => emitted+='insert')();\n      graph.on('update', (oldLink, newLink) => emitted+='update');\n      graph.on('update', (oldLink, newLink) => emitted+='update')();\n      graph.on('remove', (oldLink, newLink) => emitted+='remove');\n      graph.on('remove', (oldLink, newLink) => emitted+='remove')();\n      graph.insert({ source: ids[0], target: ids[0] }, (error, id1) => {\n        assert.ifError(error);\n        assert.equal(emitted, 'linkinsert');\n        done();\n      });\n    });\n    it('should update and check handler', (done) => {\n      var graph = generateGraph();\n      var emitted = '';\n      graph.on('link', (oldLink, newLink) => emitted+='link');\n      graph.on('link', (oldLink, newLink) => emitted+='link')();\n      graph.on('unlink', (oldLink, newLink) => emitted+='unlink');\n      graph.on('unlink', (oldLink, newLink) => emitted+='unlink')();\n      graph.on('insert', (oldLink, newLink) => emitted+='insert');\n      graph.on('insert', (oldLink, newLink) => emitted+='insert')();\n      graph.on('update', (oldLink, newLink) => emitted+='update');\n      graph.on('update', (oldLink, newLink) => emitted+='update')();\n      graph.on('remove', (oldLink, newLink) => emitted+='remove');\n      graph.on('remove', (oldLink, newLink) => emitted+='remove')();\n      graph.insert({ source: ids[1], target: ids[1] }, function(error, id1) {\n        assert.ifError(error);\n        graph.update(id1, { target: ids[2] }, function(error, count) {\n          assert.ifError(error);\n          assert.equal(emitted, 'linkinsertlinkunlinkupdate');\n          done();\n        });\n      });\n    });\n    it('should remove and check handler', (done) => {\n      var graph = generateGraph();\n      var emitted = '';\n      graph.on('link', (oldLink, newLink) => emitted+='link');\n      graph.on('link', (oldLink, newLink) => emitted+='link')();\n      graph.on('unlink', (oldLink, newLink) => emitted+='unlink');\n      graph.on('unlink', (oldLink, newLink) => emitted+='unlink')();\n      graph.on('insert', (oldLink, newLink) => emitted+='insert');\n      graph.on('insert', (oldLink, newLink) => emitted+='insert')();\n      graph.on('update', (oldLink, newLink) => emitted+='update');\n      graph.on('update', (oldLink, newLink) => emitted+='update')();\n      graph.on('remove', (oldLink, newLink) => emitted+='remove');\n      graph.on('remove', (oldLink, newLink) => emitted+='remove')();\n      graph.insert({ source: ids[3], target: ids[3] }, function(error, id1) {\n        assert.ifError(error);\n        graph.remove(id1, function(error, count) {\n          assert.ifError(error);\n          assert.equal(emitted, 'linkinsertunlinkremove');\n          done();\n        });\n      });\n    });\n  });\n}"]}